## ステップ8: Gitフックの活用

[目次に戻る](git学習目次.md)

Gitフックは、特定のイベントが発生した際に自動的に実行されるスクリプトで、開発ワークフローの自動化や品質向上に役立ちます。ここでは、Gitフックの基本概念と主要なフックの種類、そして具体的な活用例について解説します。

### 1. Gitフックの基本概念

Gitフックは、Gitリポジトリ内の特定のイベント（例：コミット、マージ、プッシュなど）の前後に自動的に実行されるスクリプトです。これにより、コードの検証やテストの自動実行、コミットメッセージのフォーマットチェックなど、さまざまな処理を自動化できます。 

### 2. 主要なフックの種類

Gitフックには、クライアントサイドとサーバーサイドの2種類があります。ここでは、クライアントサイドの主要なフックを紹介します。

- **pre-commit**: `git commit`コマンド実行直前に実行され、コミット内容の検証やテストの実行に使用されます。 

- **prepare-commit-msg**: コミットメッセージエディタ起動直前に実行され、デフォルトのコミットメッセージの編集や自動生成に利用されます。 

- **commit-msg**: コミットメッセージの入力後、コミットが完了する前に実行され、メッセージのフォーマットチェックなどに使用されます。 

- **post-commit**: コミット完了後に実行され、通知の送信やログの更新などに利用されます。 

### 3. Gitフックの活用例

以下に、具体的なGitフックの活用例を示します。

- **コミット前のコードスタイルチェック（pre-commit）**

  コミット前にコードのスタイルを自動チェックし、規約違反があればコミットを中止するスクリプトを設定します。

  ```bash
  #!/bin/sh
  if ! ./run-linter.sh; then
    echo "コードスタイルチェックに失敗しました。"
    exit 1
  fi
  ```

  このスクリプトを`.git/hooks/pre-commit`に配置し、実行権限を付与します。 

- **コミットメッセージのフォーマットチェック（commit-msg）**

  コミットメッセージが特定のフォーマットに従っているかを検証し、違反があればコミットを中止するスクリプトを設定します。

  ```bash
  #!/bin/sh
  COMMIT_MSG_FILE=$1
  COMMIT_MSG=$(cat $COMMIT_MSG_FILE)
  if ! echo "$COMMIT_MSG" | grep -qE "^[A-Z]+-[0-9]+: .+"; then
    echo "コミットメッセージは 'JIRA-123: メッセージ' の形式で入力してください。"
    exit 1
  fi
  ```

  このスクリプトを`.git/hooks/commit-msg`に配置し、実行権限を付与します。 

これらのフックを活用することで、開発プロセスの自動化やコード品質の向上が期待できます。

---

**参考**

- [Git フックの基本的な使い方 - Qiita](https://qiita.com/noraworld/items/c562de68a627ae792c6c)
  - Gitフックの基本的な使い方や設定方法について詳しく解説しています。

- [Git フック | Atlassian Git Tutorial](https://www.atlassian.com/ja/git/tutorials/git-hooks)
  - Gitフックの種類や活用方法について、具体的な例を交えて説明しています。

- [Gitのフックの説明と挙動の検証 - Qiita](https://qiita.com/mima_ita/items/dcaa3789022d2a9ab929)
  - 各種Gitフックの動作タイミングや設定方法について、詳細に検証しています。 